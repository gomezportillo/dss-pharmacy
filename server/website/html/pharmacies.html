<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pharmacies - Pharmacy manager</title>
  <meta name="description" content="Pharmacy manager">

  <!-- style -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/main.css">

  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css">

  <!-- scripts -->
  <script src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <!-- Google Maps API -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDBl7Lhhxg4UBj19zByED6drVMgsh59fhw&callback=initMap"></script>

</head>
<body>
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <a class="navbar-brand" href="/">
          <b>Pharmacy manager</b>
        </a>
      </div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
          <li class="divider-vertical"></li>
          <li class="active"><a href="/pharmacies"><span class="glyphicon glyphicon-plus-sign"></span> Pharmacies</a></li>
          <li class="divider-vertical"></li>
          <li><a class="active" href="/products"><span class="glyphicon glyphicon-tint"></span> Products</a></li>
          <li class="divider-vertical"></li>
          <li><a href="/users"><span class="glyphicon glyphicon-user"></span> Users</a></li>
          <li class="divider-vertical"></li>
        </ul>

        <ul class="nav navbar-nav navbar-right">
          <li class="divider-vertical"></li>
          <li><a href="/cart"><span class="glyphicon glyphicon-shopping-cart"></span> Cart</a></li>
        </ul>
      </div>
    </nav>

    <div class="container">
      <br><br><br><br>
      <h1>Pharmacies</h1>
      <hr>
      <div class="col-md-12" id="map">
        <script>
        function initMap()
        {
          // REF. https://developers.google.com/maps/documentation/javascript/adding-a-google-map
          var center = {lat: 37.197361, lng: -3.623561};
          // Center map
          map = new google.maps.Map(document.getElementById('map'), {zoom: 17, center: center});
        }
        </script>
      </div>
    </div>
  </div>

  <script>
  $( document ).ready(function()
  {
    load_pharmacies_coordinates();
  });

  var debug = true;
  if ( debug )
  {
    var SERVER_REST_URL = "http://localhost:5000/rest/pharmacies";
  }
  else
  {
    var SERVER_REST_URL = "https://dss-pharmacy.herokuapp.com/rest/pharmacies";
  }
  function load_pharmacies_coordinates()
  {
    $.ajax({
      url: SERVER_REST_URL + '/all',
      type: 'GET',
      dataType: 'json',
      success: function (pharmacies)
      {
        console.log(pharmacies);
        $.each(pharmacies, function (key, value)
        {
          coord_tmp = {lat: value.latitude, lng: value.longitude}
          var marker = new google.maps.Marker({position: coord_tmp, map: map, title: key});
        });
      },
      error: function (request, message, error)
      {
        console.log("Error performing GET on " + SERVER_REST_URL);
      }
    });
  }
  </script>
</body>
</html>
